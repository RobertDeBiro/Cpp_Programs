@startuml Factory_Method_Pattern_Pizza_Store

' Factory Method Pattern - Pizza Store Class Diagram
' Demonstrates parallel class hierarchies: Creator and Product

skinparam classAttributeIconSize 0
skinparam backgroundColor #FFFFFF
skinparam class {
    BackgroundColor<<creator>> #FFE0B2
    BorderColor<<creator>> #E65100
    BackgroundColor<<product>> #C8E6C9
    BorderColor<<product>> #2E7D32
}

' ===== CREATOR HIERARCHY =====

abstract class PizzaStore <<creator>> {
    --
    + orderPizza(type : string) : unique_ptr<Pizza>
    # {abstract} createPizza(type : string) : unique_ptr<Pizza>
}

class NYPizzaStore <<creator>> {
    --
    # createPizza(type : string) : unique_ptr<Pizza>
}

class ChicagoPizzaStore <<creator>> {
    --
    # createPizza(type : string) : unique_ptr<Pizza>
}

' ===== PRODUCT HIERARCHY =====

abstract class Pizza <<product>> {
    # name : string
    # dough : string
    # sauce : string
    # toppings : vector<string>
    --
    + prepare() : void
    + bake() : void
    + cut() : void
    + box() : void
    + getName() : string
    + ~Pizza()
}

class NYStyleCheesePizza <<product>> {
    --
    + NYStyleCheesePizza()
    + ~NYStyleCheesePizza()
}

class NYStylePepperoniPizza <<product>> {
    --
    + NYStylePepperoniPizza()
    + ~NYStylePepperoniPizza()
}

class ChicagoStyleCheesePizza <<product>> {
    --
    + ChicagoStyleCheesePizza()
    + cut() : void
    + ~ChicagoStyleCheesePizza()
}

class ChicagoStylePepperoniPizza <<product>> {
    --
    + ChicagoStylePepperoniPizza()
    + cut() : void
    + ~ChicagoStylePepperoniPizza()
}

' ===== RELATIONSHIPS =====

' Creator hierarchy
PizzaStore <|-- NYPizzaStore
PizzaStore <|-- ChicagoPizzaStore

' Product hierarchy
Pizza <|-- NYStyleCheesePizza
Pizza <|-- NYStylePepperoniPizza
Pizza <|-- ChicagoStyleCheesePizza
Pizza <|-- ChicagoStylePepperoniPizza

' Factory Method dependency (Creator creates Product)
PizzaStore ..> Pizza : <<creates>>
NYPizzaStore ..> NYStyleCheesePizza : <<creates>>
NYPizzaStore ..> NYStylePepperoniPizza : <<creates>>
ChicagoPizzaStore ..> ChicagoStyleCheesePizza : <<creates>>
ChicagoPizzaStore ..> ChicagoStylePepperoniPizza : <<creates>>

' ===== NOTES =====

note top of PizzaStore
  **Abstract Creator**

  - Declares factory method createPizza()
  - Implements template method orderPizza()
  - Depends only on Pizza abstraction
  - Does NOT know about concrete pizzas

  **Template Method:**
  orderPizza() {
    pizza = createPizza(type)  ← Hook
    pizza.prepare()
    pizza.bake()
    pizza.cut()
    pizza.box()
  }
end note

note right of NYPizzaStore
  **Concrete Creator**

  Overrides factory method to
  create NY-style products:
  - NYStyleCheesePizza
  - NYStylePepperoniPizza

  Encapsulates knowledge of
  which concrete classes to
  instantiate for NY region.
end note

note right of ChicagoPizzaStore
  **Concrete Creator**

  Overrides factory method to
  create Chicago-style products:
  - ChicagoStyleCheesePizza
  - ChicagoStylePepperoniPizza

  Encapsulates regional
  variation logic.
end note

note bottom of Pizza
  **Abstract Product**

  Defines interface for
  objects created by factory.

  Contains common operations:
  - prepare(), bake(), cut(), box()

  Subclasses provide regional
  variations (ingredients,
  cutting style, etc.)
end note

note left of NYStyleCheesePizza
  **Concrete Products**

  NY Style characteristics:
  - Thin crust dough
  - Marinara sauce
  - Diagonal cut slices
  - Reggiano cheese topping

  Chicago Style characteristics:
  - Extra thick crust (deep dish)
  - Plum tomato sauce
  - Square cut slices
  - Mozzarella cheese topping
end note

note as N1
  **Parallel Class Hierarchies**

  Creator Hierarchy:
  PizzaStore → NYPizzaStore, ChicagoPizzaStore

  Product Hierarchy:
  Pizza → NYStylePizza, ChicagoStylePizza

  Both hierarchies vary together but
  remain decoupled through abstractions.
end note

note as N2
  **Dependency Inversion**

  High-level module (PizzaStore) depends
  on abstraction (Pizza), NOT on
  low-level modules (concrete pizzas).

  Dependency arrows point UPWARD:
  Concrete → Abstract

  This is the essence of Factory Method!
end note

note as N3
  **Key Design Decisions**

  1. createPizza() is PROTECTED
     - Internal implementation detail
     - Clients call orderPizza(), not createPizza()

  2. orderPizza() is PUBLIC
     - Client-facing API
     - Defines invariant workflow

  3. unique_ptr<Pizza> return type
     - Automatic memory management
     - Clear ownership semantics
end note

@enduml
