@startuml Decorator_Pattern_Starbuzz_Coffee

' Decorator Pattern - Starbuzz Coffee Class Diagram
' Shows wrapping of components with decorators

skinparam classAttributeIconSize 0
skinparam backgroundColor #FFFFFF
skinparam class {
    BackgroundColor<<interface>> #E1F5FE
    BorderColor<<interface>> #01579B
    BackgroundColor<<component>> #C8E6C9
    BorderColor<<component>> #2E7D32
    BackgroundColor<<decorator>> #FFF9C4
    BorderColor<<decorator>> #F57F17
}

' Abstract Component
abstract class Beverage <<component>> {
    # description : string
    --
    + getDescription() : string
    + {abstract} cost() : double
    + ~Beverage()
}

' Concrete Components (Beverages)
class Espresso <<component>> {
    + Espresso()
    + cost() : double
}

class HouseBlend <<component>> {
    + HouseBlend()
    + cost() : double
}

class DarkRoast <<component>> {
    + DarkRoast()
    + cost() : double
}

class Decaf <<component>> {
    + Decaf()
    + cost() : double
}

' Abstract Decorator
abstract class CondimentDecorator <<decorator>> {
    + {abstract} getDescription() : string
    + ~CondimentDecorator()
}

' Concrete Decorators
class Mocha <<decorator>> {
    - beverage : unique_ptr<Beverage>
    --
    + Mocha(unique_ptr<Beverage>)
    + getDescription() : string
    + cost() : double
}

class Whip <<decorator>> {
    - beverage : unique_ptr<Beverage>
    --
    + Whip(unique_ptr<Beverage>)
    + getDescription() : string
    + cost() : double
}

class Soy <<decorator>> {
    - beverage : unique_ptr<Beverage>
    --
    + Soy(unique_ptr<Beverage>)
    + getDescription() : string
    + cost() : double
}

' Relationships

' Concrete components extend Beverage
Beverage <|-- Espresso
Beverage <|-- HouseBlend
Beverage <|-- DarkRoast
Beverage <|-- Decaf

' Decorator extends Beverage (IS-A)
Beverage <|-- CondimentDecorator

' Concrete decorators extend CondimentDecorator
CondimentDecorator <|-- Mocha
CondimentDecorator <|-- Whip
CondimentDecorator <|-- Soy

' Decorators wrap Beverage (HAS-A)
Mocha o--> "1" Beverage : wraps
Whip o--> "1" Beverage : wraps
Soy o--> "1" Beverage : wraps

note top of Beverage
  **Abstract Component**

  Defines interface for
  objects that can have
  responsibilities added
  to them dynamically
end note

note right of Espresso
  **Concrete Components**

  Core beverage objects
  that can be wrapped
  with decorators

  Each defines its base cost
end note

note left of CondimentDecorator
  **Abstract Decorator**

  - Extends Beverage (IS-A)
  - Contains Beverage* (HAS-A)

  This dual nature allows
  decorators to be used
  wherever Beverages are expected
end note

note bottom of Mocha
  **Concrete Decorators**

  Add responsibilities
  to the component:
  - Wrap a beverage
  - Add own cost
  - Delegate to wrapped object

  cost() = own_cost + wrapped->cost()
  Recursive delegation!
end note

note as N1
  **Key Insight**

  Decorators have the SAME TYPE
  as objects they decorate.

  This allows unlimited wrapping:
  Mocha → Mocha → Whip → Espresso

  Each decorator adds behavior
  before/after delegating to
  the wrapped object.
end note

note as N2
  **Example Usage**

  auto b = make_unique<Espresso>();
  b = make_unique<Mocha>(move(b));
  b = make_unique<Mocha>(move(b));
  b = make_unique<Whip>(move(b));

  Result: "Espresso, Mocha, Mocha, Whip"
  Cost: 1.99 + 0.20 + 0.20 + 0.10 = 2.49
end note

@enduml
